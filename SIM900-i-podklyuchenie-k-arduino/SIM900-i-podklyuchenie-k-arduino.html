<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Untitled</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.line-block{white-space: pre-line;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h2 id="sim900-и-подключение-к-arduino"><a href="https://randomnerdtutorials.com/sim900-gsm-gprs-shield-arduino/">SIM900 и подключение к Arduino</a></h2>
<p><strong><em>Схема подключения:</em></strong></p>
<ul>
<li>Выходы с модуля TX и RX подключить к пинам 2 и 3 на Arduino UNO.</li>
<li>Общее заземление между модулем и Arduino UNO.</li>
<li>Не использовать выходы RS232 на боковой панели печатной платы модуля, так как они выдают напряжение +-7 В и могут повредить Arduino.</li>
<li>Необходимо использовать контакты последовательного выхода уровня TTL (рядом с подключением антенны).</li>
</ul>
<h3 id="sim900-gprs-gsm-shield-kit-для-arduino"><a href="https://aliexpress.ru/item/32649551828.html?spm=a2g2w.orderdetail.0.0.28644aa6Y2cp8t&amp;sku_id=59650770966&amp;_ga=2.236838337.1358291795.1752296331-257156806.1703682747">SIM900 GPRS GSM Shield Kit для Arduino</a></h3>
<p><embed src="SIM900.webp" /></p>
<p><strong><em>Описание:</em></strong></p>
<ul>
<li>100% новый и высокое качество</li>
<li>Экран GPRS основан на модуле SIM900 от SIMCOM и совместим с его клонами.</li>
<li>GPRS Shield предоставляет вам способ общения с помощью сети сотовых телефонов GSM.</li>
<li>Экран позволяет вам получать SMS, MMS, GPRS и аудио через UART путем отправки по командам (GSM 07,07, 07,05 и SIMCOM усилены по командам).</li>
<li>Щит также имеет 12 GPIOs, 2 PWMs и ADC модуля SIM900 (они все 2V8 логики), присутствующие на борту.</li>
</ul>
<p><strong><em>Особенности:</em></strong></p>
<ul>
<li>Четырехдиапазонный 850/900/1800/1900 МГц-будет работать в сетях GSM во всех странах мира.</li>
<li>GPRS мульти-слот класс 10/8</li>
<li>GPRS мобильная станция класса B</li>
<li>Совместим с gsm-фазой 2/2 +</li>
<li>Класс 4 (2 Вт @ 850/900 МГц)</li>
<li>Класс 1 (1 Вт @ 1800/1900 МГц)</li>
<li>Управление через команды AT-стандартные команды: GSM 07,07 и 07,05 | улучшенные команды: SIMCOM AT команды.</li>
<li>Служба коротких сообщений-так что вы можете отправить небольшое количество данных по сети (ASCII или raw hexadecimal).</li>
<li>Встроенный Стек TCP/UDP-Позволяет загружать данные на веб-сервер.</li>
<li>Поддержка RTC.</li>
<li>Выбор последовательного порта.</li>
<li>Разъемы для динамиков и наушников</li>
<li>Низкое энергопотребление-1,5 мА (режим сна)</li>
<li>Диапазон промышленных температур от-40 °C до + 85 °C</li>
<li>Размер: 8,5x5,7x2 см (прибл.)</li>
</ul>
<pre><code>- прошивка обычная: Revision:1137B10SIM900M64_ST, к сожалению не ENHANCE ...
- Одна плата имеет бумажную наклейку и версию 6_ST, а вторая глянцевую наклейку с версией 10_ST. 
Обе платы имели настройку обмена 9600 бод. 
Обновил firmware на последнюю 1137B06SIM900M64_ST_ENHANCE (17.07.2015г) модули исправны и работают.</code></pre>
<h3 id="руководство-по-использованию-sim900-gsm-gprs-shield-с-arduino"><a href="https://randomnerdtutorials.com/sim900-gsm-gprs-shield-arduino/">Руководство по использованию SIM900 GSM GPRS Shield с Arduino</a></h3>
<blockquote>
<p>GSM расшифровывается как Global System for Mobile Communications и является международным стандартом мобильной связи.</p>
<p>GPRS расшифровывается как General Packet Radio Service. GPRS — это мобильная услуга в сетях сотовой связи 2G и 3G.</p>
</blockquote>
<p>Плата GSM GPRS особенно полезна, так как позволяет:</p>
<ul>
<li>Подключитесь к Интернету через сеть GPRS</li>
<li>Отправлять и получать SMS-сообщения</li>
<li>Совершать и принимать телефонные звонки</li>
</ul>
<p>Благодаря своим возможностям он идеально подходит для проектов с использованием Arduino, таких как:</p>
<ul>
<li>Дистанционное управление электронными устройствами — отправка SMS для включения чего-либо;</li>
<li>Получайте уведомления — отправляйте SMS на свой мобильный телефон, если в вашем доме будет обнаружено движение.</li>
<li>Получайте данные с датчиков — отправляйте на свой мобильный телефон периодические SMS с ежедневными данными о погоде.</li>
</ul>
<h3 id="предварительные-шаги">Предварительные шаги</h3>
<ul>
<li><strong><em>Покрытие GSM.</em></strong> Убедитесь, что у вас есть покрытие в сетях GSM 850 МГц, GSM 900 МГц, DCS 1800 МГц или PCS 1900 МГц. Под GSM мы подразумеваем 2G.</li>
<li><strong><em>Предоплаченная SIM-Карта.</em></strong> Мы рекомендуем вам использовать тарифный план с предоплатой или безлимитный тарифный план для тестирования. В противном случае, если что-то пойдёт не так, вам, возможно, придётся оплатить огромный счёт за сотни SMS-сообщений, отправленных по ошибке. В этом руководстве мы используем тарифный план с предоплатой и безлимитными SMS.</li>
</ul>
<p>В защитном чехле используется SIM-карта стандартного размера, а не микро- или нано-SIM. Если у вас микро- или нано-SIM, вы можете приобрести адаптер для SIM-карты.</p>
<ul>
<li><strong><em>Отключите блокировку PIN-кода.</em></strong> Чтобы использовать SIM-карту с защитой, необходимо отключить блокировку PIN-кодом. Самый простой способ сделать это — вставить SIM-карту в смартфон и отключить блокировку PIN-кодом в настройках безопасности телефона.</li>
</ul>
<p>Например, пройти через: Настройки &gt; Расширенные настройки &gt; Безопасность &gt; Блокировку SIM-карты и отключить блокировку sim-карты с помощью pin-кода.</p>
<p><embed src="LockSIMcard.webp" /></p>
<ul>
<li><strong><em>Выбор правильного источника питания.</em></strong> На плате есть разъем постоянного тока для подачи питания, как показано на рисунке ниже.</li>
</ul>
<p><embed src="DC-jack.webp" /></p>
<p>Рядом с разъемом питания находится переключатель для выбора источника питания. Рядом с переключателем на плате есть стрелка, указывающая положение переключателя для использования внешнего источника питания. Переместите переключатель, чтобы использовать внешний источник питания, как показано выше.</p>
<blockquote>
<p><strong><em>Для питания платы рекомендуется использовать блок питания 5В, способный выдавать 2А. Также можно использовать питание 9В, 1А или 12В, 1А.</em></strong></p>
</blockquote>
<h3 id="gprs-shield-v2"><a href="https://wiki.amperka.ru/продукты:arduino-gprs-shield-v2">GPRS Shield v2</a></h3>
<h4 id="различие-версий">Различие версий</h4>
<blockquote>
<p>В первой версии GPRS-Shield напряжение питания шилда составляло не более 9 В.</p>
<p>В новой ревизии обвязка питания была изменена и теперь допускает питание до 12 В.</p>
</blockquote>
<p><img src="gprs_vs.png" /></p>
<h3 id="аппаратное-обеспечение-sim900-gsm-gprs-shield">Аппаратное обеспечение SIM900 GSM GPRS Shield</h3>
<p>На рисунке ниже показана задняя сторона платы. На ней есть держатель для SIM-карты и батарейка CR1220 на 3 В для часов реального времени (RTC).</p>
<p><img src="Zadnjaja-storona-platy.jpg" /></p>
<p>На рисунке ниже показаны наиболее важные компоненты платы, на которые следует обратить внимание.</p>
<p><embed src="GSM-shield-labels.webp" /></p>
<h3 id="приступая-к-работе">Приступая к работе</h3>
<ol type="1">
<li>Вставьте SIM-карту в держатель SIM-карты — убедитесь, что вы ознакомились с предварительными шагами в предыдущем разделе.</li>
</ol>
<p><embed src="insert-SIM.webp" /></p>
<ol start="2" type="1">
<li><p>Убедитесь, что антенна хорошо подключена.</p></li>
<li><p>При выборе последовательного порта убедитесь, что перемычка подключена, как показано на рисунке ниже, для использования программного обеспечения.</p></li>
</ol>
<blockquote>
<p><a href="#">В нашем случае, 2025-07-14, плата заработала через последовательный порт без перемычек</a>.</p>
</blockquote>
<p><embed src="software-serial.webp" /></p>
<ol start="4" type="1">
<li><p>Подключите щит к внешнему источнику питания 5 В. Убедитесь, что вы выбрали внешний источник питания с помощью тумблера рядом с разъёмом постоянного тока.</p></li>
<li><p>Для включения/выключения экрана нажмите и удерживайте кнопку питания около 2 секунд.</p></li>
</ol>
<p><embed src="power-key.webp" /></p>
<ol start="6" type="1">
<li>Затем загорится индикатор состояния, а индикатор NetLight будет мигать каждые 800 мс, пока не будет найдена сеть. После обнаружения сети индикатор NetLight начнет мигать каждые три секунды.</li>
</ol>
<p>Примечание: вы можете автоматически включать защиту с помощью программного обеспечения. Узнайте, как это сделать, в разделе Автоматическое включение защиты после примеров кода.</p>
<ol start="7" type="1">
<li>Вы можете проверить, правильно ли работает плата, отправив AT-команды из Arduino IDE с помощью программатора FTDI, как мы покажем далее в этом руководстве.</li>
</ol>
<h3 id="at-команды-sim900">AT-команды SIM900</h3>
<ul>
<li>перевести SIM900 в текстовый режим: AT+CMGF=1</li>
<li>отправить SMS на номер: AT+CMGS=НОМЕР_ТЕЛЕФОНА (в международном формате)</li>
<li>прочесть первое SMS из папки «Входящие»: AT+CMGR=1</li>
<li>прочесть второе SMS из папки «Входящие»: AT+CMGR=2</li>
<li>прочесть все SMS из папки «Входящие»: AT+CMGR=ALL</li>
<li>позвонить по номеру: ATDP+ НОМЕР_ТЕЛЕФОНА (в международном формате)</li>
<li>завершить вызов: ATH</li>
<li>поступил входящий вызов: ATA</li>
</ul>
<h3 id="проверка-at-команд-sim900">Проверка at команд sim900</h3>
<p><a href="https://we.easyelectronics.ru/part/gsm-gprs-modul-sim900-chast-vtoraya.html" class="uri">https://we.easyelectronics.ru/part/gsm-gprs-modul-sim900-chast-vtoraya.html</a></p>
<p><a href="https://codernet.ru/articles/drugoe/modem_sim900_at-komandyi_na_russkom_kak_nachat_obshhenie_s_modulem/" class="uri">https://codernet.ru/articles/drugoe/modem_sim900_at-komandyi_na_russkom_kak_nachat_obshhenie_s_modulem/</a></p>
<p>Проверка AT-команд для модуля SIM900 — это процесс анализа ответов модуля на запросы, которые используются для проверки его работы, настройки или получения информации.</p>
<p>AT-команды — это короткие текстовые строки, которые модуль распознаёт, когда находится в командном режиме.</p>
<blockquote>
<p>Важно: чтобы команду воспринял модуль, в её конце нужно поставить символ перевода каретки «».</p>
</blockquote>
<p>SIM900 работают в трёх режимах: <strong><em>тестовый</em></strong> — модуль отвечает, поддерживает ли команда, и если поддерживает, то с какими параметрами; <strong><em>чтение</em></strong> — возвращаются текущие значения параметра; <strong><em>запись</em></strong> — после символа «=» идут новые значения параметров.</p>
<p>Чтобы проверить работу модуля, нужно отправлять AT-команды и анализировать ответы. Некоторые особенности анализа:</p>
<p>Проверка завершения вывода — если строка ответа равна коду конечного результата, вывод из командной строки завершён, и модуль готов к приёму новых команд.</p>
<p>Анализ префикса для строк информационного текста ответа — если команда имеет префикс, нужно проверить, начинается ли строка с него, и если да, обработать строку, иначе игнорировать её.</p>
<p>Проверка формата ответа — если команда имеет префикс, нужно проверить, начинается ли строка с него, и если да, обработать строку, иначе игнорировать её.</p>
<p><a href="https://translated.turbopages.org/proxy_u/en-ru.ru.901fc3fd-687dcabc-a6b8d5ae-74722d776562/https/stackoverflow.com/questions/36850022/sim900-at-commands-response-parsing">Правильная стратегия анализа вывода команды AT заключается в следующем:</a></p>
<p>Отправьте командную строку AT (с правильным завершением “”).</p>
<p>Считывайте по одному символу, полученному от модема, пока не получите полную строку, завершающуюся “”, а затем проанализируйте эту строку.</p>
<p>Если строка соответствует конечному коду результата, значит, вывод из командной строки завершён (и модем готов принимать новые команды). Это первое, что нужно проверить!</p>
<p>Если у выполняемой команды AT есть префикс для строк информационного текста (он есть почти у всех), проверьте, начинается ли строка с этого префикса. Если да, обработайте строку, в противном случае проигнорируйте её.</p>
<p>Если у выполняемой команды AT нет префикса, вы, вероятно, захотите вывести на экран всё до получения окончательного кода результата. Это применимо только к устаревшим командам, таким как ATI, и при их разборе вам может быть важно, будет ли выводиться эхо-сигнал.</p>
<p>C командой AT+CMGL придётся повозиться немного больше, так как ответы разбиты на несколько строк.</p>
<p>Прежде всего, лучшим источником информации должна быть техническая документация производителя, а вторым по значимости — официальная спецификация <a href="">3GPP 27.005</a>, в которой стандартизирована команда AT+CMGL.</p>
<p>Ответ на запрос AT+CMGL в текстовом режиме указан как</p>
<pre><code>+CMGL: &lt;index&gt;,&lt;stat&gt;,&lt;oa/da&gt;,[&lt;alpha&gt;],[&lt;scts&gt;][,&lt;tooa/toda&gt;,
&lt;length&gt;]&lt;CR&gt;&lt;LF&gt;&lt;data&gt;[&lt;CR&gt;&lt;LF&gt;
+CMGL: &lt;index&gt;,&lt;stat&gt;,&lt;da/oa&gt;,[&lt;alpha&gt;],[&lt;scts&gt;][,&lt;tooa/toda&gt;,
&lt;length&gt;]&lt;CR&gt;&lt;LF&gt;&lt;data&gt;[...]]</code></pre>
<p>Таким образом, после получения строки, начинающейся с «+CMGL:», все последующие строки до пустой строки («») относятся к этому формату.</p>
<p>См. <a href="https://translated.turbopages.org/proxy_u/en-ru.ru.901fc3fd-687dcabc-a6b8d5ae-74722d776562/https/stackoverflow.com/questions/31677801/when-requesting-com-port-returns-the-same-request/31688517#31688517">этот ответ</a> об общей структуре кода и его работе, хотя, как уже было сказано выше, многострочный ответ требует дополнительной обработки. Я бы использовал что-то вроде следующего (<strong><em>непроверенный код</em></strong>):</p>
<pre><code>enum CMGL_state {
    CMGL_NONE,
    CMGL_PREFIX,
    CMGL_DATA
};

// Extra prototype needed because of Arduino&#39;s auto-prototype generation which often breaks compilation when enums are used.
enum CMGL_state parse_CMGL(enum CMGL_state state, String line);
enum CMGL_state parse_CMGL(enum CMGL_state state, String line)
{
    if (line.equals(&quot;\r\n&quot;) {
        return CMGL_NONE;
    }
    if (line.startsWith(&quot;+CMGL: &quot;) {
        return CMGL_PREFIX;
    }
    if (state == CMGL_PREFIX || state == CMGL_DATA) {
        return CMGL_DATA;
    }
    return CMGL_NONE;
}

...

write_to_modem(&quot;AT+CMGL=\&quot;ALL\&quot;\r&quot;);
CMGL_state = CMGL_NONE;
goto start;
do {
    CMGL_state = parse_CMGL(CMGL_state, line);
    switch (CMGL_state) {
    case CMGL_PREFIX:
        process_prefix(line); // or whatever you want to do with this line
        break;
    case CMGL_DATA:
        process_data(line); // or whatever you want to do with this line
        break;
    case CMGL_NONE:
    default:
        break;
    }
start:
    line = read_line_from_modem();
} while (! is_final_result_code(line))</code></pre>
<p>Если вы используете arduino, я бы порекомендовал вам хорошую библиотеку! Вам не нужно разбираться в этом. Попробуйте <a href="">http://www.gsmlib.org/</a> или любую другую, которая вам понравится.</p>
<p>Я приведу здесь один пример.</p>
<pre><code>#include &quot;SIM900.h&quot;
#include &lt;SoftwareSerial.h&gt;
//If not used, is better to exclude the HTTP library,
//for RAM saving.
//If your sketch reboots itself proprably you have finished,
//your memory available.
//#include &quot;inetGSM.h&quot;

//If you want to use the Arduino functions to manage SMS, uncomment the lines below.
#include &quot;sms.h&quot;
SMSGSM sms;

//To change pins for Software Serial, use the two lines in GSM.cpp.

//GSM Shield for Arduino
//www.open-electronics.org
//this code is based on the example of Arduino Labs.

//Simple sketch to send and receive SMS.

int numdata;
boolean started=false;
char smsbuffer[160];
char n[20];

void setup() 
{
  //Serial connection.
  Serial.begin(9600);
  Serial.println(&quot;GSM Shield testing.&quot;);
  //Start configuration of shield with baudrate.
  //For http uses is raccomanded to use 4800 or slower.
  if (gsm.begin(2400)){
    Serial.println(&quot;\nstatus=READY&quot;);
    started=true;  
  }
  else Serial.println(&quot;\nstatus=IDLE&quot;);

  if(started){
    //Enable this two lines if you want to send an SMS.
    //if (sms.SendSMS(&quot;3471234567&quot;, &quot;Arduino SMS&quot;))
      //Serial.println(&quot;\nSMS sent OK&quot;);
  }

};

void loop() 
{
  if(started){
    //Read if there are messages on SIM card and print them.
    if(gsm.readSMS(smsbuffer, 160, n, 20))
    {
      Serial.println(n);
      Serial.println(smsbuffer);
    }
    delay(1000);
  }
};
</code></pre>
<h3 id="дополнительная-информация-по-at-командам"><a href="SIM900AT20Command20ManualV103.653745192.pdf">Дополнительная информация по AT-командам</a></h3>
<h3 id="примеры-работы-с-платой-sim900-и-использования-команд">Примеры работы с платой SIM900 и использования команд</h3>
<h4 id="все-в-одном-или-что-нового-в-gsm-модуле-sim900"><a href="https://wireless-e.ru/gsm/sim900/">«Все в одном», или Что нового в GSM-модуле SIM900</a></h4>
<h4 id="at-команды-gsm-модема-на-чипе-sim900"><a href="https://2150692.ru/faq/47-at-komandy-a6">AT-команды GSM модема на чипе SIM900</a></h4>
<h4 id="gsm-модуль-и-arduino"><a href="https://radiodepector.ru/gsm-modul/">GSM модуль и Arduino</a></h4>
<h4 id="обзор-платы-gsmgprs-sim900-shield"><a href="https://3d-diy.ru/blog/gsm-gprs-sim900-shield/?ysclid=md40vd2ciy856822215">Обзор платы GSM/GPRS SIM900 Shield</a></h4>
<p>Контакты, используемые с Arduino:</p>
<pre><code>D0 - Не используется, если выбран программный Software serial порт для обмена с Шильдом;
D1 - Не используется, если выбран программный Software serial порт для обмена с Шильдом;
D7 - Используется, если выбран программный Software serial порт для обмена с Шильдом;
D8 - Используется, если выбран программный Software serial порт для обмена с Шильдом;
D9 - Используется для программного контроля включения и отключения SIM900;
Предупреждение: A4 и A5 подсоединены к I2C контактам на SIM900. Однако SIM900 не поддерживает использование I2C.</code></pre>
<h3 id="тестирование-платы-с-помощью-программатора-ftdi">Тестирование платы с помощью программатора FTDI</h3>
<p>Чтобы проверить, всё ли работает правильно, вы можете протестировать плату, отправив AT-команды с последовательного монитора Arduino IDE. Для этого вам понадобится программатор FTDI.</p>
<ol type="1">
<li>Подключите программатор FTDI к плате GSM, как показано на рисунке ниже.</li>
</ol>
<p><embed src="GSM-FTDI-circuit-1.webp" /></p>
<ol start="2" type="1">
<li><p>Откройте Arduino IDE и выберите нужный COM-порт.</p></li>
<li><p>Откройте последовательный монитор.</p></li>
<li><p>Выберите скорость передачи данных 19200 бод — по умолчанию на плате установлено значение 19200 — и возврат каретки. Напишите AT в поле ввода и нажмите Enter.</p></li>
</ol>
<blockquote>
<p><a href="#">В нашем случае, 2025-07-14, по умолчанию была установлена скорость передачи данных 9600 бод</a>.</p>
</blockquote>
<ol start="5" type="1">
<li>Если всё работает правильно, плата ответит ОК.</li>
</ol>
<h3 id="подключение-платы-к-arduino">Подключение платы к Arduino</h3>
<p><embed src="GSM-Arduino-circuit.webp" /></p>
<h3 id="отправка-sms-сообщения">Отправка SMS-сообщения</h3>
<pre><code>/*********
  Complete project details at http://randomnerdtutorials.com  
*********/

#include &lt;SoftwareSerial.h&gt;

// Configure software serial port
SoftwareSerial SIM900(7, 8); 

void setup() {
  // Arduino communicates with SIM900 GSM shield at a baud rate of 19200
  // Make sure that corresponds to the baud rate of your module
  SIM900.begin(9600);
  // Give time to your GSM shield log on to network
  delay(20000);   
  
  // Send the SMS
  sendSMS();
}

void loop() 
{ 
}

void sendSMS()
{

  // AT+CMGF=1\r             - перевели SIM900 в текстовый режим (SMS mode) 
  // AT+CMGS=&quot;+79214524295&quot; &quot;Hello SMS from tve!&quot; 
  
  // AT command to set SIM900 to SMS mode
  SIM900.print(&quot;AT+CMGF=1\r&quot;); 
  delay(100);

  // REPLACE THE X&#39;s WITH THE RECIPIENT&#39;S MOBILE NUMBER
  // USE INTERNATIONAL FORMAT CODE FOR MOBILE NUMBERS
  
  // В примере от [GPRS Shield v2]
  // gprs.sendSMS(&quot;+79263995140&quot;, &quot;Hello SMS from Amperka!&quot;);
  
  SIM900.println(&quot;AT+CMGS=\&quot;+XXXXXXXXXXXX\&quot;&quot;); 
  delay(100);
  
  // REPLACE WITH YOUR OWN SMS MESSAGE CONTENT
  SIM900.println(&quot;Message example from Arduino Uno.&quot;); 
  delay(100);

  // End AT command with a ^Z, ASCII code 26
  SIM900.println((char)26); 
  delay(100);
  SIM900.println();
  // Give module time to send SMS
  delay(5000); 
}
</code></pre>
<p>В этом коде вы начинаете с подключения библиотеки SoftwareSerial.h и создаёте программный последовательный порт на контактах 7 и 8. (Контакт 7 используется как RX, а контакт 8 — как TX)</p>
<pre><code>#include &lt;SoftwareSerial.h&gt;
SoftwareSerial SIM900(7, 8);</code></pre>
<p>Созданная функция sendSMS() фактически отправляет SMS. Эта функция использует команды AT: <strong><em>AT+CMGF=1и AT + CMGS</em></strong>.</p>
<p>Вам нужно изменить номер мобильного телефона получателя на: (замените <strong><em>X</em></strong> на номер телефона получателя)</p>
<pre><code>SIM900.println(&quot;AT + CMGS = \&quot;XXXXXXXXXXX\&quot;&quot;);</code></pre>
<p>Номер мобильного телефона получателя должен быть указан в международном формате.</p>
<p>Затем в следующей строке вы можете отредактировать текст, который хотите отправить.</p>
<pre><code>// ЗАМЕНИТЕ НА СВОЁ СОБСТВЕННОЕ SMS-СООБЩЕНИЕ 
SIM900.println(&quot;Пример сообщения от Arduino Uno.&quot;)</code></pre>
<h3 id="чтение-полученного-sms-сообщения">Чтение полученного SMS-сообщения</h3>
<p>Чтобы прочитать входящее SMS, загрузите приведённый ниже код в Arduino. После загрузки подождите 20 секунд, пока плата не установит соединение. Затем протестируйте скрипт, отправив SMS на номер SIM-карты платы. SMS отобразится на последовательном мониторе Arduino со скоростью передачи данных 19200 бод.</p>
<pre><code>/*********
  Complete project details at http://randomnerdtutorials.com  
*********/

#include &lt;SoftwareSerial.h&gt;

// Configure software serial port
SoftwareSerial SIM900(7, 8);
//Variable to save incoming SMS characters
char incoming_char=0;

void setup() {
  // Arduino communicates with SIM900 GSM shield at a baud rate of 19200
  // Make sure that corresponds to the baud rate of your module
  SIM900.begin(19200);
  // For serial monitor
  Serial.begin(19200); 
  // Give time to your GSM shield log on to network
  delay(20000);

  // AT command to set SIM900 to SMS mode
  SIM900.print(&quot;AT+CMGF=1\r&quot;); 
  delay(100);
  // Set module to send SMS data to serial out upon receipt 
  SIM900.print(&quot;AT+CNMI=2,2,0,0,0\r&quot;);
  delay(100);
}

void loop() {
  // Display any text that the GSM shield sends out on the serial monitor
  if(SIM900.available() &gt;0) {
    //Get the character from the cellular serial port
    incoming_char=SIM900.read(); 
    //Print the incoming character to the terminal
    Serial.print(incoming_char); 
  }
}</code></pre>
<p>В этом коде вы настраиваете модуль на отправку данных SMS на последовательный выход:</p>
<pre><code>SIM900.print(&quot;AT+CNMI=2,2,0,0,0\r&quot;);</code></pre>
<p>Вы сохраняете входящие символы из SMS-сообщения в переменной incoming_char. Вы считываете символы с помощью функции SIM900.read().</p>
<h3 id="совершение-телефонного-звонка">Совершение телефонного звонка</h3>
<pre><code>/*********
  Complete project details at http://randomnerdtutorials.com  
*********/

#include &lt;SoftwareSerial.h&gt;

// Configure software serial port
SoftwareSerial SIM900(7, 8); 

void setup() {
  // Arduino communicates with SIM900 GSM shield at a baud rate of 19200
  // Make sure that corresponds to the baud rate of your module
  SIM900.begin(19200);
  // Give time to your GSM shield log on to network
  delay(20000);

  // Make the phone call
  callSomeone();
}

void loop() {
  
}

void callSomeone() {
  // REPLACE THE X&#39;s WITH THE NUMER YOU WANT TO DIAL
  // USE INTERNATIONAL FORMAT CODE FOR MOBILE NUMBERS
  SIM900.println(&quot;ATD + +XXXXXXXXX;&quot;);
  delay(100);
  SIM900.println();
  
 // In this example, the call only last 30 seconds
 // You can edit the phone call duration in the delay time
  delay(30000);
  // AT command to hang up
  SIM900.println(&quot;ATH&quot;); // hang up
}</code></pre>
<p>Чтобы совершить звонок, используйте функцию callSomeone(), которая использует команду ATD.</p>
<pre><code>SIM900.println(&quot;ATD + +XXXXXXXXX;&quot;);</code></pre>
<p>Вам нужно заменить X на номер телефона, по которому вы хотите позвонить.</p>
<p>Не забудьте подключить микрофон и наушники, чтобы совершить звонок.</p>
<p>В этом примере кода вызов завершается через 30 секунд с помощью команды ATH:</p>
<pre><code>SIM900.println(&quot;ATH&quot;); </code></pre>
<p>Отбой через 30 секунд не очень полезен, но в качестве примера работает хорошо. Идея заключается в том, что вы используете команду ATH при срабатывании события. Например, подключите к Arduino кнопку, которая при нажатии отправляет команду ATH для завершения вызова.</p>
<h3 id="отправка-и-получение-sms-и-звонков-с-помощью-sim900-gsm-shield-и-arduino"><a href="https://lastminuteengineers.com/sim900-gsm-shield-arduino-tutorial/">Отправка и получение SMS и звонков с помощью SIM900 GSM Shield и Arduino</a></h3>
<h3 id="комментарии">Комментарии</h3>
<ol type="1">
<li>Можно ли включить эту плату с помощью Arduino, не нажимая на кнопку?</li>
</ol>
<ul>
<li>Есть способ использовать программный триггер, чтобы не нажимать кнопку для включения платы. Для этого нужно подключить D9 на плате к D9 на Arduino и добавить в код следующий фрагмент в функции setup(), который эквивалентен нажатию кнопки питания:</li>
</ul>
<pre><code>digitalWrite(9, HIGH);
delay(1000);
digitalWrite(9, LOW);
delay(5000);</code></pre>
<ol start="2" type="1">
<li>На некоторых платах нужно припаять контакт <strong><em>R13</em></strong>, см. «Автоматическое включение платы».</li>
</ol>
<ul>
<li>Внутри маркировки R13 есть два крошечных контакта. Вам нужно припаять эти контакты друг к другу.</li>
</ul>
<blockquote>
<p>При использовании аккумуляторов 18650 следует иметь в виду, что если плата будет постоянно включена, аккумуляторы быстро разрядятся. Поэтому плату нужно включать только тогда, когда требуется отправить сообщение, позвонить и т. д.</p>
</blockquote>
<blockquote>
<p>Когда плата подключается к сети, индикатор NetLight должен мигать каждые три секунды (это означает, что устройство правильно подключено к сети). Чтобы включить плату, нажмите кнопку питания и удерживайте её около двух секунд. Затем загорится индикатор состояния, а индикатор NetLight будет мигать каждые 800 мс, пока устройство не найдёт сеть. Когда устройство найдёт сеть, индикатор NetLight начнёт мигать каждые три секунды.</p>
<p>Если устройство не подключается к сети, проблема может быть связана с вашей картой или с GSM-модулем.</p>
<p>Перед отправкой AT-команд GSM-модуль должен быть подключен к сети.</p>
</blockquote>
<ol start="3" type="1">
<li>У меня возникла проблема на первом этапе! Индикатор сети мигает только раз в секунду и остаётся в таком положении в течение длительного времени… Это значит, что он не может подключиться к сети. Я не знаю почему?</li>
</ol>
<p>Мой модуль подключён к источнику питания 9В 1А, SIM-карта установлена правильно.</p>
<ul>
<li>Поддерживает ли ваше местоположение сеть 2G? SIM900 - это сетевое устройство 2G.</li>
</ul>
<p>Найдите список AT-команд и узнайте больше о качестве сигнала, подключениях и т. д. Вы можете начать с проверки качества сигнала с помощью команды, например — SIM900.println(“AT+CSQ”) — (и отправить вывод обратно в последовательный порт).</p>
<p>Также проверьте команды AT+COPS? и AT+CREG? в различных вариантах…</p>
<p>Так вы узнаете, работает ли ваша антенна (CSQ) и есть ли несущие частоты, к которым вы можете подключиться или к которым уже подключены.</p>
<p>Вы можете узнать гораздо больше о своей плате и подключении с помощью AT-команд, даже без подключения к сети (или до него) !</p>
<p>И я признаю, что подключить эти платы по-прежнему сложно… но вы узнаете гораздо больше о своей плате, попробовав эти команды 🙂</p>
<ol start="4" type="1">
<li>Хотя мне удалось отправить SMS с помощью GSM-модуля, я не могу его прочитать.</li>
</ol>
<p>Я выполнил описанные вами действия по настройке скорости передачи данных и т. д., но SMS-сообщение по-прежнему не отправляется на последовательный порт.</p>
<ul>
<li>Убедитесь, что на вашей SIM-карте не установлен PIN-код (это распространённая ошибка).</li>
</ul>
<ol start="5" type="1">
<li>Может в примерах кода не хватает:</li>
</ol>
<pre><code>// Импортируем библиотеку GSM
#include ...</code></pre>
<ul>
<li>В примерах для связи с SIM900 через последовательный порт используется библиотека SoftwareSerial. Нет необходимости подключать другую библиотеку.</li>
</ul>
<ol start="6" type="1">
<li>Можно ли использовать контакты 0 и 1 вместо контактов 7 и 8? Если да, то нужно ли мне по-прежнему использовать библиотеку SoftwareSerial? Я использую Arduino UNO R3.</li>
</ol>
<ul>
<li>Если вы используете контакты 0 и 1, значит, вы используете аппаратный последовательный порт. Значит, вам не нужна эта библиотека. Если вы собираетесь использовать аппаратный последовательный порт, вам нужно изменить перемычки на плате, чтобы использовать аппаратный последовательный порт. <a href="https://i0.wp.com/randomnerdtutorials.com/wp-content/uploads/2017/08/software-serial.jpg?w=700&amp;ssl=1">На этом изображении показаны перемычки для использования программного последовательного порта</a>, которые необходимо заменить на аппаратный последовательный порт.</li>
</ul>
<ol start="7" type="1">
<li>Может ли SIM-карта sim900 подключаться к сети 4G?</li>
</ol>
<ul>
<li>SIM900 не работает с 4G. Вам нужен другой модуль, например SIM800C.</li>
</ul>
<ol start="8" type="1">
<li>Могу ли я использовать SIM-карту любого типа? Операторы продают SIM-карты для сетей 2G и USIM-карты для сетей 3G/4G. Будет ли это работать с SIM-картой любого типа?</li>
</ol>
<ul>
<li>Плата работает с любым типом SIM-карты. Например, вы можете использовать карту 3G или 4G. Но модуль будет работать только в том случае, если в вашем регионе есть сеть 2G.</li>
</ul>
<ol start="9" type="1">
<li>Я хочу совершать автоматические звонки (с Arduino) определённому человеку, и после того, как он ответит, должна включиться запись. Есть ли какое-то событие, которое сообщает мне о том, что человек ответил на исходящий звонок?</li>
</ol>
<ul>
<li><a href="https://stackoverflow.com/questions/63240900/sim900-gsm-module-how-to-check-if-the-outgoing-call-is-answered">Надеюсь, это поможет</a></li>
</ul>
<blockquote>
<p>2G — это система GSM, которая обеспечивает телефонные звонки и SMS. Если вы полностью отключите 2G, то, думаю, у вас не будет телефонной связи, поскольку она по-прежнему работает на 2G. (3G/4G/5G — это сервисы передачи данных, работающие параллельно с GSM.)</p>
<p>Поскольку SIM900 поддерживает 2G, и вы используете его только для отправки/получения SMS, я думаю, он продолжит работать. Если вы используете функции передачи данных через 2G, то, возможно, они будут каким-то образом отключены, но при этом SMS и телефонная связь будут работать. Но, скорее всего, им ничего не стоит поддерживать эту функцию, поскольку она в любом случае является частью GSM, которая по-прежнему необходима для базовой телефонной связи.</p>
</blockquote>
<p><strong><em>Ноэль, 1 марта 2023 года, 11:02</em></strong></p>
<p><strong><em>Стоит отметить несколько моментов:</em></strong></p>
<p>На некоторых из этих плат вместо основного чипа SIM900 установлен SIM900A. Это становится очевидным, если посмотреть на плату или на реальные фотографии, а не на старые «стандартные» фотографии от интернет-поставщиков. Разница в том, что <strong><em>SIM900A работает в двух диапазонах, а не в четырёх</em></strong>. У меня есть несколько плат, и одна из них с SIM900A не подключается, несмотря на то, что я использую SIM-карты, которые работают на других платах.</p>
<p>Существует также версия этой платы немного меньшего размера без держателя аккумулятора и слота для SIM-карты на задней панели. В них также нет разъёмов для подключения телефона и чипа RTC. Отсутствие RTC не является проблемой, так как время можно определить по входящим звонкам и сообщениям. Удачи вам в ваших проектах…</p>
<h3 id="примеры-по-материалам">Примеры по материалам</h3>
<h4 id="send-receive-sms-call-sim900-v2"><a href="Send-Receive-SMS-Call-SIM900-v2.pdf">Send-Receive-SMS-Call-SIM900-v2</a></h4>
<h4 id="testing-at-commands.ino"><a href="Testing-AT-Commands.ino" class="uri">Testing-AT-Commands.ino</a></h4>
</body>
</html>
